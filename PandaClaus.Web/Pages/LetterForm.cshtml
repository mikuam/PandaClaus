@page
@model LetterFormModel
@{
    ViewData["Title"] = "Dodaj List";
}

@section HeaderJS {
    <link rel="stylesheet" href="https://geowidget.inpost.pl/inpost-geowidget.css" />
    <script src='https://geowidget.inpost.pl/inpost-geowidget.js' defer></script>
    <script>
        console.log('added event listener');
        document.addEventListener('onpointselect', (event) => {
            console.log('Selected point: ', event.detail.name);
            document.getElementById('paczkomatCode').value = event.detail.name;
            // Close the modal after selection
            var modal = bootstrap.Modal.getInstance(document.getElementById('geowidgetModal'));
            if (modal) {
                modal.hide();
            }
        });
    </script>
    <style>
        #geowidgetModal .modal-dialog {
            max-width: 90%;
            width: 900px;
        }
        #geowidgetModal inpost-geowidget {
            height: 600px;
            display: block;
        }
    </style>
}

<div class="container-xxl bg-white p-0">
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <h1 class="mt-4 mb-4">Panda Claus 2025</h1>
                    <p><b>Panda Claus powraca! Nadchodzi wielkimi krokami i zbiera listy od dzieci, które go wyczekują.</b></p>
                    <p><b>Rodzicu, zanim jednak wypełnisz formularz, przeczytaj poniższe instrukcje.</b></p>
                    <p>Pandowy Święty Mikołaj i cała zgraja niezastąpionych pandowych elfów, również w tym roku dopięli wszystko na ostatni guzik, aby po raz kolejny móc spełniać świąteczne marzenia dzieci, których rodzeństwo choruje onkologicznie lub odeszło z powodu choroby. Chcemy, by magiczna moc świąt dotarła również do nich.</p>
                    <p><b>Jak wziąć udział w akcji?</b></p>
                    <p>Zasady są proste! Akcja jest przeznaczona dla rodzeństwa dzieci chorych onkologicznie (do 3 lat po stwierdzeniu remisji choroby) oraz dzieci, które przeżyły stratę rodzeństwa z powodu choroby nowotworowej (do 3 lat po śmierci). Zgłaszane osoby nie mogą przekroczyć 18 roku życia.</p>
                    <p><b>Rodzicu, to ważne informacje dla Ciebie!</b> Każde dziecko prosimy o napisanie listu do Panda Clausa (Pandowego Świętego Mikołaja), w którym opowie o swoim wymarzonym prezencie (wartość do 400 zł). List musi być napisany ręcznie, a jeśli dziecko nie potrafi jeszcze pisać lub ma z tym trudności, możesz mu w tym pomóc. Dekorowanie listu zostaw dziecku — na pewno świetnie sobie poradzi.  Listy pisane na komputerze nie będą przyjmowane. </p>
                    <p>Gotowy list zeskanuj i prześlij za pomocą formularza zgłoszeniowego na stronie akcji <a href="https://pandaclaus.pl/LetterForm">https://pandaclaus.pl/LetterForm</a></p>
                    <p><b>Kilka ważnych zasad:</b></p>
                    <ol>
                        <li>Wartość prezentu wskazanego w liście dla jednego dziecka nie może przekraczać 350 zł.</li>
                        <li>Prezent wskazany w liście powinien być takich wymiarów, aby można było go wysłać <b>Paczkomatem InPost</b>, który jest naszym Partnerem wysyłkowym.</li>
                        <li>Listy <b>nie mogą zawierać innych danych osobowych</b> dziecka poza imieniem i wiekiem.</li>
                        <li>Prezentem nie mogą być żywe zwierzęta.</li>
                    </ol>

                    <p><b>Kiedy wysyłać zgłoszenia?</b></p>
                    <p>Zgłoszenia przyjmujemy do 19 listopada 2025 r. do godziny 12:00. W razie potrzeby termin może ulec zmianie. Panda Claus dołoży wszelkich starań, aby prezenty trafiły do dzieci jeszcze przed Świętami – do 24 grudnia.</p>
                    <p>Listy napisane przez dzieci, zostaną udostępnione na naszych kanałach w mediach społecznościowych oraz na stronie akcji. Darczyńcy akcji będą mogli wybrać listy od dzieci, dla których przygotują podarunki. Wiemy, że dzięki temu prezenty będą trafione! </p>

                    <p>Wszystkie pytania prosimy kierować na adres: <a href="mailto:pandaclaus@pandateam.pl">pandaclaus@pandateam.pl</a></p>
                    <p><b>Partnerzy akcji:</b></p>
                </div>
                <div style="text-align: center;">
                    <img src="~/img/inpost_logo.png" class="m-3 m-lg-5" alt="InPost logo" />
                    <img src="~/img/grupa_mtp_logo.png" class="m-3 m-lg-5" alt="Grupa MTP logo" height="100" />
                    <img src="~/img/dudacars_logo.svg" class="m-3 m-lg-5" alt="Duda Cars logo" height="100" />
                    <img src="~/img/remondis_logo.svg" class="m-3 m-lg-5" alt="Remondis logo" height="100" />
                    <img src="~/img/bibliopunkt_logo.jpg" class="m-3 m-lg-5" alt="Bibliopunkt logo" height="100" />
                </div>
            </div>
        </div>
        <hr class="mb-4" />

        @*
        <div class="container col-lg-6 offset-lg-3">
            <p>Przyjmowanie zgłoszeń w Panda Claus 2025 zostało już zakończone</p>
        </div>
        *@
        <form method="post" enctype="multipart/form-data">
            <div class="container col-lg-6 offset-lg-3">
                @if (!ModelState.IsValid)
                {
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <i class="fa fa-exclamation-triangle me-2"></i>
                        <div asp-validation-summary="All" class="text-danger"></div>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                }
                
                <div class="row mb-4">
                    <div class="mb-6">
                        <label asp-for="ParentName">Imię rodzica/opiekuna prawnego <span class="text-danger">*</span></label>
                        <input asp-for="ParentName" type="text" class="form-control" id="parentName" required>
                    </div>
                    <div class="mb-6">
                        <label asp-for="ParentSurname">Nazwisko rodzica/opiekuna prawnego <span class="text-danger">*</span></label>
                        <input asp-for="ParentSurname" type="text" class="form-control" id="parentSurname" required>
                    </div>
                </div>

                <div class="mb-4">
                    <label asp-for="PhoneNumber">Numer telefonu rodzica/opiekuna prawnego <span class="text-danger">*</span></label>
                    <input asp-for="PhoneNumber" type="tel" class="form-control" id="phoneNumber" 
                           pattern="[4-8][0-9]{8}" 
                           placeholder="np. 501234567"
                           maxlength="9"
                           required>
                    <div class="form-text">Podaj 9-cyfrowy numer telefonu bez kierunkowego +48 (np. 501234567)</div>
                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                </div>
                <div class="mb-4">
                    <label asp-for="Email">Adres e-mail rodzica/opiekuna prawnego <span class="text-danger">*</span></label>
                    <input asp-for="Email" type="text" class="form-control" id="email" required>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        <label asp-for="Street">Ulica <span class="text-danger">*</span></label>
                        <input asp-for="Street" type="text" class="form-control" id="street" required>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="HouseNumber">Numer domu <span class="text-danger">*</span></label>
                        <input asp-for="HouseNumber" type="text" class="form-control" id="houseNumber" required>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="ApartmentNumber">Numer lokalu</label>
                        <input asp-for="ApartmentNumber" type="text" class="form-control" id="apartmentNumber">
                    </div>
                </div>

                <div class="mb-4">
                    <label asp-for="City">Miasto<span class="text-danger">*</span></label>
                    <input asp-for="City" type="text" class="form-control" id="city" required>
                </div>
                <div class="mb-4">
                    <label asp-for="PostalCode">Kod pocztowy (format: XX-XXX)<span class="text-danger">*</span></label>
                    <input asp-for="PostalCode" type="text" class="form-control" id="postalCode" pattern="[0-9]{2}-[0-9]{3}" required>
                </div>
                <div class="mb-4">
                    <label asp-for="PaczkomatCode">Kod paczkomatu InPost <span class="text-danger">*</span></label>
                    <div class="input-group">
                        <input asp-for="PaczkomatCode" type="text" class="form-control" id="paczkomatCode" pattern="([A-Z]{3,4}[0-9]{2,3}[A-Z]{1,3}|POP-[A-Z]{3}[0-9]{0,4})" required>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#geowidgetModal">
                            <i class="fa fa-map-marker-alt me-2"></i>Wybierz na mapie
                        </button>
                    </div>
                    <div class="form-text">Kod paczkomatu znajdziesz na stronie: <a href="https://inpost.pl/znajdz-paczkomat" target="_blank">Paczkomaty InPost</a> lub kliknij przycisk "Wybierz na mapie"</div>
                </div>
                <div class="mb-4">
                    <label asp-for="ChildName">Imię dziecka zgłaszanego do akcji (Jeżeli dodajesz kilkoro dzieci, dodaj je osobno)<span class="text-danger">*</span></label>
                    <input asp-for="ChildName" type="text" class="form-control" id="childName" required>
                </div>
                <div class="mb-4">
                    <label asp-for="ChildAge">Wiek dziecka zgłaszanego do akcji <span class="text-danger">*</span></label>
                    <input asp-for="ChildAge" type="number" class="form-control" id="childAge" required>
                </div>
                <div class="mb-4">
                    <label asp-for="Description">Opiszcie krótko swoją historię i z jakiego powodu bierzecie udział w akcji. Ta treść będzie widoczna na stronie z listem i będzie zachęcała Darczyńców do jego realizacji. <span class="text-danger">*</span></label>
                    <textarea asp-for="Description" rows="3" class="form-control" id="description" required></textarea>
                </div>
                <div class="mb-4">
                    <label asp-for="Presents">Opisz listę prezentów, o które prosi dziecko<span class="text-danger">*</span></label>
                    <textarea asp-for="Presents" rows="3" class="form-control" id="presents" required></textarea>
                </div>
                <div class="mb-4">
                    <label asp-for="LetterPhotos">Wyślij skan lub zdjęcie listu <span class="text-danger">*</span></label>
                    <input asp-for="LetterPhotos" type="file" class="form-control" id="file" accept=".jpg, .png, .jpeg, .bmp, .tif, .tiff" required multiple>
                </div>

                <div class="form-check mb-4">
                    <input class="form-check-input" type="checkbox" id="privacy" required>
                    <label class="form-check-label" for="privacy">
                        <span class="text-danger">*</span> Akceptuję politykę prywatności Fundacji Panda Team im. Michałka Tarachowicza dostępną na stronie <a href="https://pandateam.pl/polityka-prywatnosci/" target="_blank">https://pandateam.pl/polityka-prywatnosci/</a>
                    </label>
                </div>

                <div class="form-check mb-4">
                    <input class="form-check-input" type="checkbox" id="rules" required>
                    <label class="form-check-label" for="rules">
                        <span class="text-danger">*</span> Wyrażam zgodę na udział w akcji Panda Claus 2024 i akceptuję zasady akcji dostępne na stronie <a href="https://pandaclaus.pl/Privacy" target="_blank">https://pandaclaus.pl/Privacy</a>
                    </label>
                </div>

                <button type="submit" class="btn btn-primary py-3 px-5 mt-3 float-end">Wyślij</button>
            </div>
        </form>
    </div>
</div>

<!-- InPost Geowidget Modal -->
<div class="modal fade" id="geowidgetModal" tabindex="-1" aria-labelledby="geowidgetModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="geowidgetModalLabel">
                    <i class="fa fa-map-marker-alt me-2"></i>Wybierz Paczkomat InPost
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-0">
                <inpost-geowidget language='pl' config='parcelcollect' onpoint="onpointselect"
                                  token='@Model.InPostGeoWidgetToken'></inpost-geowidget>
            </div>
        </div>
    </div>
</div>